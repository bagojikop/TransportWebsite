<div class="user-access-wrapper">
  <!-- Sidebar Component -->
  <app-sidebar></app-sidebar>

  <!-- Main Content -->
  <div class="main-content">
    <div class="user-access-container">
      <!-- Header -->
      <div class="header">
        <div class="header-left">
          <h1>User Access</h1>
          <p class="sub-header">Manage user permissions</p>
        </div>
        <div class="header-right">
          <div class="total-users-badge">
            <span class="total-label">Total Users</span>
            <span class="total-number">{{ filteredUsers.length }}</span>
          </div>
        </div>
      </div>

      <!-- Search Section -->
      <div class="search-section">
        <div class="search-wrapper">
          <svg class="search-icon" viewBox="0 0 24 24" width="18" height="18">
            <path fill="currentColor" d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
          <input 
            type="text" 
            class="search-input"
            placeholder="Search users..." 
            [(ngModel)]="searchTerm"
            (input)="filterUsers()"
          />
          <button *ngIf="searchTerm" class="clear-search" (click)="clearSearch()">Ã—</button>
        </div>
      </div>

      <!-- Users Table -->
      <div class="table-card">
        <table class="users-table">
          <thead>
            <tr>
              <th>User</th>
              <th>Contact</th>
              <th>Add</th>
              <th>Edit</th>
              <th>Delete</th>
              <th>Print</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of filteredUsers">
              <td>
                <div class="user-info">
                  <span class="user-avatar">{{ getUserInitials(user.fullName) }}</span>
                  <div class="user-details">
                    <span class="user-name">{{ user.fullName }}</span>
                    <span class="user-username">@{{ user.username }}</span>
                  </div>
                </div>
              </td>
              <td>
                <div class="contact-info">
                  <span class="user-email">{{ user.email }}</span>
                  <span class="user-phone">{{ user.mobileNo }}</span>
                </div>
              </td>
              <td>
                <label class="toggle-switch">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="user.permissions.add"
                    (change)="updatePermissions(user)"
                  />
                  <span class="toggle-slider"></span>
                </label>
              </td>
              <td>
                <label class="toggle-switch">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="user.permissions.edit"
                    (change)="updatePermissions(user)"
                  />
                  <span class="toggle-slider"></span>
                </label>
              </td>
              <td>
                <label class="toggle-switch">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="user.permissions.delete"
                    (change)="updatePermissions(user)"
                  />
                  <span class="toggle-slider"></span>
                </label>
              </td>
              <td>
                <label class="toggle-switch">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="user.permissions.print"
                    (change)="updatePermissions(user)"
                  />
                  <span class="toggle-slider"></span>
                </label>
              </td>
            </tr>
            <tr *ngIf="filteredUsers.length === 0">
              <td colspan="6" class="empty-state">
                <p>No users found</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Action Footer -->
      <div class="action-footer">
        <div class="unsaved-indicator" *ngIf="hasChanges">
          <span class="dot"></span>
          <span>Unsaved changes</span>
        </div>
        <div class="action-buttons">
          <button class="btn btn-secondary" (click)="cancelChanges()" [disabled]="!hasChanges">
            Cancel
          </button>
          <button class="btn btn-primary" (click)="savePermissions()" [disabled]="!hasChanges">
            Save Changes
          </button>
        </div>
      </div>
    </div>
  </div>
</div>